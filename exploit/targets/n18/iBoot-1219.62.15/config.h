// N18AP, iOS 5.1.1
#define CACHELINE_SIZE      (0x40)

#define PRINTF              (0x4FF240D4 + 1)
#define PLATFORM_RESET      (0x4FF15B4C + 1)
#define MEMCPY              (0x4FF24428)
#define MEMSET              (0x4FF24744)
#define ARM_CLEAN_CACHES    (0x4FF17364)
#define FREE                (0x4FF10CD0 + 1)
#define MEMALIGN            (0x4FF10F4C + 1)
#define HEAP_ADD_CHUNK      (0x4FF10E18 + 1)
#define ENV_GET             (0x4FF0F2BC + 1)
#define ENV_SET             (0x4FF0F34C + 1)
#define NAND_NVRAM_READ     (0x4FF0A710 + 1)
#define NVRAM_SAVE          (0x4FF132D8 + 1)
#define FS_MOUNT            (0x4FF19F14 + 1)
#define UPDATE_DEVICE_TREE  (0x4FF1209C + 1)
#define FIND_NODE           (0x4FF0F0C0 + 1)
#define FIND_PROPERTY       (0x4FF0F050 + 1)
#define RANDOM_GET_BYTES    (0x4FF1442C + 1)
#define LOAD_KERNELCACHE    (0x4FF1318C + 1)
#define BOOT_DARWIN         (0x4FF00890 + 1)
#define CONTAINS_BOOT_ARGS  (0x4FF12B9C + 1)
#define STRLCAT             (0x4FF24984 + 1)

#define BDEV_LIST           (0x4FF305BC)
#define BOOT_ARGS_STRUCT    (0x4FF32D0C)
#define HEAP_METADATA       (0x4FF31300)
#define FREE_ADDR           (0x4FF10CD0)

/* 
 * STAGE2_BASE now reserves 32MiBs to make sure we don't overwrite NAND metadata
 * allocated in the big heap chunk in case of unclean shutdown (0x7D0000 in size)
 */
#define HEAP_BASE           (STAGE2_BASE + 0x4000 /* reserve 0x4000 for the shellcode itself */)
#define HEAP_END            (0x4FC00000)

#define BOOT_ARGS_PATCH_ADDR1   (0x4FF13128)
#define BOOT_ARGS_PATCH_ADDR2   (0x4FF1312C)
#define BOOT_ARGS_NEW_ADDR      (0x4FF2CB58)

#define IMAGE3_PATCH    (0x4FF11C70)

#define DEBUG_ENABLED_PATCH_ADDR1   (0x4FF12274)
#define DEBUG_ENABLED_PATCH_ADDR2   (0x4FF12276)

#define UPDATE_DEVICE_TREE_TRAMP        (0x4FF00104)
#define UPDATE_DEVICE_TREE_HOOK_ADDR    (0x4FF13062)
#define UPDATE_DEVICE_TREE_HOOK_PATCH   (0xF84FF7ED)
